# date-fns Internationalization Examples

> Locale-aware formatting and internationalization patterns. See [SKILL.md](../SKILL.md) for core concepts.

---

## Locale Setup

### Good Example - Centralized Locale Configuration

```typescript
// lib/date-locales.ts
import {
  enUS,
  enGB,
  de,
  fr,
  es,
  it,
  ja,
  ko,
  zhCN,
  zhTW,
  pt,
  ptBR,
  ru,
  ar,
  nl,
  pl,
  tr,
  vi,
  th,
  sv,
} from "date-fns/locale";
import type { Locale } from "date-fns";

// Supported locale map
const locales: Record<string, Locale> = {
  "en-US": enUS,
  "en-GB": enGB,
  "en-AU": enGB, // Fallback to GB
  "de-DE": de,
  "de-AT": de,
  "de-CH": de,
  "fr-FR": fr,
  "fr-CA": fr,
  "es-ES": es,
  "es-MX": es,
  "es-AR": es,
  "it-IT": it,
  "ja-JP": ja,
  "ko-KR": ko,
  "zh-CN": zhCN,
  "zh-TW": zhTW,
  "pt-PT": pt,
  "pt-BR": ptBR,
  "ru-RU": ru,
  "ar-SA": ar,
  "ar-AE": ar,
  "nl-NL": nl,
  "pl-PL": pl,
  "tr-TR": tr,
  "vi-VN": vi,
  "th-TH": th,
  "sv-SE": sv,
};

// Default fallback
const DEFAULT_LOCALE = enUS;

// Get locale by code with fallback
function getDateLocale(localeCode: string): Locale {
  // Try exact match
  if (locales[localeCode]) {
    return locales[localeCode];
  }

  // Try language only (e.g., "de" from "de-DE")
  const languageOnly = localeCode.split("-")[0];
  const languageMatch = Object.entries(locales).find(([key]) =>
    key.startsWith(languageOnly),
  );

  if (languageMatch) {
    return languageMatch[1];
  }

  return DEFAULT_LOCALE;
}

// Named export
export { getDateLocale, locales, DEFAULT_LOCALE };
export type { Locale };
```

**Why good:** centralized management, handles regional variants with fallbacks, easy to extend

---

## Locale-Aware Formatting

### Good Example - Format with Locale

```typescript
import { format, formatRelative, formatDistance } from "date-fns";
import { getDateLocale } from "./date-locales";

// Format presets
const DATE_FORMAT_SHORT = "P"; // Locale-aware short date
const DATE_FORMAT_MEDIUM = "PP"; // Locale-aware medium date
const DATE_FORMAT_LONG = "PPP"; // Locale-aware long date
const DATE_FORMAT_FULL = "PPPP"; // Locale-aware full date
const TIME_FORMAT = "p"; // Locale-aware time
const DATETIME_FORMAT = "PPpp"; // Date and time combined

// Utility functions
function formatDateLocalized(
  date: Date,
  localeCode: string,
  formatStr: string = DATE_FORMAT_MEDIUM,
): string {
  const locale = getDateLocale(localeCode);
  return format(date, formatStr, { locale });
}

function formatRelativeLocalized(
  date: Date,
  baseDate: Date,
  localeCode: string,
): string {
  const locale = getDateLocale(localeCode);
  return formatRelative(date, baseDate, { locale });
}

function formatDistanceLocalized(
  date: Date,
  baseDate: Date,
  localeCode: string,
  addSuffix: boolean = true,
): string {
  const locale = getDateLocale(localeCode);
  return formatDistance(date, baseDate, { locale, addSuffix });
}

// Usage
const date = new Date(2026, 0, 15);

// Short date in different locales
formatDateLocalized(date, "en-US", DATE_FORMAT_SHORT); // "01/15/2026"
formatDateLocalized(date, "de-DE", DATE_FORMAT_SHORT); // "15.01.2026"
formatDateLocalized(date, "ja-JP", DATE_FORMAT_SHORT); // "2026/01/15"

// Full date in different locales
formatDateLocalized(date, "en-US", DATE_FORMAT_FULL);
// "Thursday, January 15th, 2026"

formatDateLocalized(date, "de-DE", DATE_FORMAT_FULL);
// "Donnerstag, 15. Januar 2026"

formatDateLocalized(date, "ja-JP", DATE_FORMAT_FULL);
// "2026年1月15日木曜日"

formatDateLocalized(date, "ar-SA", DATE_FORMAT_FULL);
// "الخميس، 15 يناير 2026"
```

**Why good:** uses locale-aware format tokens (P/PP/PPP), handles RTL languages, consistent across app

---

## Getting Localized Names

### Good Example - Month and Weekday Names

```typescript
import { format, eachDayOfInterval, startOfWeek, addDays } from "date-fns";
import { getDateLocale } from "./date-locales";

const MONTHS_COUNT = 12;
const DAYS_IN_WEEK = 7;

// Get localized month names
function getMonthNames(
  localeCode: string,
  formatStr: "LLLL" | "LLL" | "LLLLL" = "LLLL",
): string[] {
  const locale = getDateLocale(localeCode);
  const REFERENCE_YEAR = 2026;

  return Array.from({ length: MONTHS_COUNT }, (_, i) =>
    format(new Date(REFERENCE_YEAR, i, 1), formatStr, { locale }),
  );
}

// Get localized weekday names
function getWeekdayNames(
  localeCode: string,
  formatStr: "EEEE" | "EEE" | "EEEEE" = "EEEE",
  weekStartsOn: 0 | 1 = 0,
): string[] {
  const locale = getDateLocale(localeCode);
  // Start from a known Sunday
  const baseSunday = new Date(2026, 0, 4); // Jan 4, 2026 is Sunday
  const weekStart = startOfWeek(baseSunday, { weekStartsOn });

  return Array.from({ length: DAYS_IN_WEEK }, (_, i) =>
    format(addDays(weekStart, i), formatStr, { locale }),
  );
}

// Usage
console.log(getMonthNames("en-US"));
// ["January", "February", ..., "December"]

console.log(getMonthNames("de-DE"));
// ["Januar", "Februar", ..., "Dezember"]

console.log(getMonthNames("ja-JP"));
// ["1月", "2月", ..., "12月"]

console.log(getWeekdayNames("en-US"));
// ["Sunday", "Monday", ..., "Saturday"]

console.log(getWeekdayNames("de-DE", "EEE"));
// ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"]

// Week starting Monday (European)
console.log(getWeekdayNames("de-DE", "EEE", 1));
// ["Mo", "Di", "Mi", "Do", "Fr", "Sa", "So"]
```

**Why good:** handles different week start days, multiple name formats, true localization

---

## Week Start Day

### Good Example - Locale-Aware Week Start

```typescript
import { startOfWeek, endOfWeek, eachDayOfInterval, format } from "date-fns";
import { getDateLocale } from "./date-locales";

// Week start by region (simplified)
const WEEK_START_BY_LOCALE: Record<string, 0 | 1 | 6> = {
  // Sunday start (Americas, East Asia)
  "en-US": 0,
  "en-CA": 0,
  "ja-JP": 0,
  "ko-KR": 0,
  "zh-CN": 0,
  "zh-TW": 0,
  // Monday start (Europe, most of world)
  "en-GB": 1,
  "de-DE": 1,
  "fr-FR": 1,
  "es-ES": 1,
  "it-IT": 1,
  "pt-BR": 1,
  "ru-RU": 1,
  // Saturday start (Middle East)
  "ar-SA": 6,
  "ar-AE": 6,
};

const DEFAULT_WEEK_START = 1; // Monday as global default

function getWeekStartsOn(localeCode: string): 0 | 1 | 6 {
  return WEEK_START_BY_LOCALE[localeCode] ?? DEFAULT_WEEK_START;
}

// Get week range for locale
function getWeekRange(
  date: Date,
  localeCode: string,
): { start: Date; end: Date } {
  const weekStartsOn = getWeekStartsOn(localeCode);
  return {
    start: startOfWeek(date, { weekStartsOn }),
    end: endOfWeek(date, { weekStartsOn }),
  };
}

// Get week days for calendar
function getWeekDays(
  weekStart: Date,
  localeCode: string,
): { date: Date; label: string }[] {
  const locale = getDateLocale(localeCode);
  const weekStartsOn = getWeekStartsOn(localeCode);

  const weekRange = {
    start: startOfWeek(weekStart, { weekStartsOn }),
    end: endOfWeek(weekStart, { weekStartsOn }),
  };

  return eachDayOfInterval(weekRange).map((date) => ({
    date,
    label: format(date, "EEE", { locale }),
  }));
}

// Usage
const today = new Date(2026, 0, 15);

// US week: Sunday - Saturday
const usWeek = getWeekRange(today, "en-US");
// start: Jan 11 (Sun), end: Jan 17 (Sat)

// German week: Monday - Sunday
const deWeek = getWeekRange(today, "de-DE");
// start: Jan 12 (Mon), end: Jan 18 (Sun)

// Saudi week: Saturday - Friday
const saWeek = getWeekRange(today, "ar-SA");
// start: Jan 10 (Sat), end: Jan 16 (Fri)
```

**Why good:** respects cultural week conventions, handles non-standard week starts (Saturday)

---

## React Integration

### Good Example - Locale Context for date-fns

```typescript
import {
  createContext,
  useContext,
  useState,
  useCallback,
  useMemo,
  type ReactNode,
} from "react";
import { format, formatDistance, formatRelative } from "date-fns";
import type { Locale } from "date-fns";
import { getDateLocale } from "./date-locales";

interface DateLocaleContextValue {
  localeCode: string;
  locale: Locale;
  weekStartsOn: 0 | 1 | 6;
  setLocaleCode: (code: string) => void;
  formatDate: (date: Date, formatStr?: string) => string;
  formatRelative: (date: Date, baseDate?: Date) => string;
  formatDistance: (date: Date, baseDate?: Date, addSuffix?: boolean) => string;
}

const DateLocaleContext = createContext<DateLocaleContextValue | null>(null);

const DEFAULT_FORMAT = "PP";

interface DateLocaleProviderProps {
  children: ReactNode;
  defaultLocale?: string;
}

function DateLocaleProvider({
  children,
  defaultLocale = "en-US",
}: DateLocaleProviderProps) {
  const [localeCode, setLocaleCode] = useState(defaultLocale);

  const locale = useMemo(() => getDateLocale(localeCode), [localeCode]);

  const weekStartsOn = useMemo(
    () => getWeekStartsOn(localeCode),
    [localeCode]
  );

  const formatDateFn = useCallback(
    (date: Date, formatStr: string = DEFAULT_FORMAT) => {
      return format(date, formatStr, { locale });
    },
    [locale]
  );

  const formatRelativeFn = useCallback(
    (date: Date, baseDate: Date = new Date()) => {
      return formatRelative(date, baseDate, { locale });
    },
    [locale]
  );

  const formatDistanceFn = useCallback(
    (date: Date, baseDate: Date = new Date(), addSuffix: boolean = true) => {
      return formatDistance(date, baseDate, { locale, addSuffix });
    },
    [locale]
  );

  const value = useMemo(
    () => ({
      localeCode,
      locale,
      weekStartsOn,
      setLocaleCode,
      formatDate: formatDateFn,
      formatRelative: formatRelativeFn,
      formatDistance: formatDistanceFn,
    }),
    [localeCode, locale, weekStartsOn, formatDateFn, formatRelativeFn, formatDistanceFn]
  );

  return (
    <DateLocaleContext.Provider value={value}>
      {children}
    </DateLocaleContext.Provider>
  );
}

function useDateLocale(): DateLocaleContextValue {
  const context = useContext(DateLocaleContext);
  if (!context) {
    throw new Error("useDateLocale must be used within DateLocaleProvider");
  }
  return context;
}

// Usage in component
function EventDate({ date }: { date: Date }) {
  const { formatDate, formatDistance } = useDateLocale();

  return (
    <div>
      <time dateTime={date.toISOString()}>
        {formatDate(date, "PPP")}
      </time>
      <span className="relative">
        ({formatDistance(date)})
      </span>
    </div>
  );
}

// Named exports
export { DateLocaleProvider, useDateLocale };
```

**Why good:** provides locale-aware formatting throughout app, memoized for performance, consistent API

---

## Combining with Intl API

### Good Example - Using Native Intl Where Appropriate

```typescript
import { format } from "date-fns";
import { getDateLocale } from "./date-locales";

// Use Intl for display-only formatting (zero bundle cost)
function formatDateIntl(date: Date, localeCode: string): string {
  return new Intl.DateTimeFormat(localeCode, {
    dateStyle: "medium",
  }).format(date);
}

// Use date-fns for complex operations (manipulation, comparison)
function formatDateFns(date: Date, localeCode: string): string {
  const locale = getDateLocale(localeCode);
  return format(date, "PP", { locale });
}

// Hybrid approach - use best tool for each job
function formatDateTime(
  date: Date,
  localeCode: string,
  options: { relative?: boolean } = {},
): string {
  // For relative formatting, date-fns is better
  if (options.relative) {
    const locale = getDateLocale(localeCode);
    return formatDistanceToNow(date, { locale, addSuffix: true });
  }

  // For simple display, Intl is free (no bundle cost)
  return new Intl.DateTimeFormat(localeCode, {
    dateStyle: "medium",
    timeStyle: "short",
  }).format(date);
}

// Get localized month/weekday names without date-fns (zero bundle cost)
function getMonthNamesIntl(
  localeCode: string,
  format: "long" | "short" | "narrow" = "long",
): string[] {
  const formatter = new Intl.DateTimeFormat(localeCode, { month: format });
  return Array.from({ length: 12 }, (_, i) =>
    formatter.format(new Date(2026, i, 1)),
  );
}
```

**Why good:** minimizes bundle size, uses native APIs where they suffice, date-fns only for complex operations
