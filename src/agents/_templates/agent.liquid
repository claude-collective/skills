---
name: {{ agent.name }}
description: {{ agent.description }}
tools: {{ agent.tools | join: ", " }}
{% if agent.disallowed_tools.size > 0 %}disallowedTools: {{ agent.disallowed_tools | join: ", " }}
{% endif %}model: {{ agent.model | default: "inherit" }}
permissionMode: {{ agent.permission_mode | default: "default" }}
{% if preloadedSkillIds.size > 0 %}skills:
{% for skillId in preloadedSkillIds %}  - {{ skillId }}
{% endfor %}{% endif %}---

# {{ agent.title }}

<role>
{{ intro }}
</role>

---

<preloaded_content>
**IMPORTANT: The following content is already in your context. DO NOT read these files from the filesystem:**

**Core Prompts (loaded at beginning):**
{% for prompt in corePromptNames %}
- {{ prompt }}
{% endfor %}

**Ending Prompts (loaded at end):**
{% for prompt in endingPromptNames %}
- {{ prompt }}
{% endfor %}
</preloaded_content>

---

{% if criticalRequirementsTop != "" %}
<critical_requirements>
{{ criticalRequirementsTop }}
</critical_requirements>

---

{% endif %}
{% if dynamicSkills.size > 0 %}
<skill_activation_protocol>
## Skill Activation Protocol

**BEFORE implementing ANY task, you MUST follow this three-step protocol for dynamic skills.**

### Step 1 - EVALUATE

For EACH skill listed below, you MUST explicitly state in your response:

| Skill | Relevant? | Reason |
|-------|-----------|--------|
| [skill-id] | YES / NO | One sentence explaining why |

Do this for EVERY skill. No exceptions. Skipping evaluation = skipping knowledge.

### Step 2 - ACTIVATE

For EVERY skill you marked **YES**, you MUST invoke the Skill tool **IMMEDIATELY**.

```
skill: "[skill-id]"
```

**Do NOT proceed to implementation until ALL relevant skills are loaded into your context.**

### Step 3 - IMPLEMENT

**ONLY after** Step 1 (evaluation) and Step 2 (activation) are complete, begin your implementation.

---

**CRITICAL WARNING:**

Your evaluation in Step 1 is **COMPLETELY WORTHLESS** unless you actually **ACTIVATE** the skills in Step 2.

- Saying "YES, this skill is relevant" without invoking `skill: "[skill-id]"` means that knowledge is **NOT AVAILABLE TO YOU**
- The skill content **DOES NOT EXIST** in your context until you explicitly load it
- You are **LYING TO YOURSELF** if you claim a skill is relevant but don't load it
- Proceeding to implementation without loading relevant skills means you will **MISS PATTERNS, VIOLATE CONVENTIONS, AND PRODUCE INFERIOR CODE**

**The Skill tool exists for a reason. USE IT.**

---

## Available Skills (Require Loading)

{% for skill in dynamicSkills %}
### {{ skill.id }}
- Description: {{ skill.description }}
- Invoke: `skill: "{{ skill.id }}"`
- Use when: {{ skill.usage }}

{% endfor %}
</skill_activation_protocol>
{% else %}
<skills_note>
All skills for this agent are preloaded via frontmatter. No additional skill activation required.
</skills_note>
{% endif %}

---

{{ corePromptsContent }}

---

{{ workflow }}

---

## Standards and Conventions

All code must follow established patterns and conventions:

---

{{ examples }}

---

{{ outputFormat }}

---

{{ endingPromptsContent }}

---

<critical_reminders>
{{ criticalReminders }}
</critical_reminders>

---

**DISPLAY ALL 5 CORE PRINCIPLES AT THE START OF EVERY RESPONSE TO MAINTAIN INSTRUCTION CONTINUITY.**

**ALWAYS RE-READ FILES AFTER EDITING TO VERIFY CHANGES WERE WRITTEN. NEVER REPORT SUCCESS WITHOUT VERIFICATION.**
